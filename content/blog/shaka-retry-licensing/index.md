---
title: 'ë¼ì´ì„ ìŠ¤ ìš”ì²­ì´ ì‹¤íŒ¨í•˜ë©´ ì–´ë–»ê²Œ ë ê¹Œ?'
date: '2026-02-14'
description: 'DRM ë¼ì´ì„ ìŠ¤ ìš”ì²­ì´ ì‹¤íŒ¨í–ˆì„ ë•Œ ì¬ì‹œë„í•˜ëŠ” retryLicensing() ê¸°ëŠ¥ì„ Shaka Playerì— êµ¬í˜„í•œ ê³¼ì •ì„ ê³µìœ í•©ë‹ˆë‹¤. 7ë…„ ëœ ì´ìŠˆ, EME ìŠ¤í™ì˜ ì œì•½, ê·¸ë¦¬ê³  Tizen ë””ë°”ì´ìŠ¤ ë©ê¹Œì§€.'
tags: ['Open Source', 'Shaka Player', 'DRM', 'EME']
category: 'ì˜¤í”ˆì†ŒìŠ¤'
featured: true
---

## "do you want work on it?"

[ì´ì „ ê¸€](/shaka-renewal-licensing/)ì—ì„œ DRM ë¼ì´ì„ ìŠ¤ ê°±ì‹  ê¸°ëŠ¥ì„ êµ¬í˜„í•œ [PR #9589](https://github.com/shaka-project/shaka-player/pull/9589)ê°€ ë¨¸ì§€ëœ ì§í›„, ë˜ í•œ ë²ˆ ë©˜ì…˜ì´ ì™”ìŠµë‹ˆë‹¤. (ì´ì •ë„ë©´ ì´ì œ ë©”ì¸í…Œì´ë„ˆë¶„ë„ ì €ë¥¼ ì•„ë¼ì‹œëŠ”ê±¸ìˆ˜ë„,,,?)

<img src="./suggestion.png" alt="ë©”ì¸í…Œì´ë„ˆì˜ ì œì•ˆ" style="width: 100%; display: block; margin: 0 auto;">
<div class="caption">"@KimKyuHoi do you want work on it after #9589?"</div>

ì´ë²ˆì—ëŠ” [Issue #1772](https://github.com/shaka-project/shaka-player/issues/1772), **`Player.retryLicensing()`** ì´ì—ˆìŠµë‹ˆë‹¤.

ê·¸ëŸ°ë° ì´ ì´ìŠˆë¥¼ ì—´ì–´ë³´ê³  ê¹œì§ ë†€ëìŠµë‹ˆë‹¤. ì´ìŠˆê°€ ìƒì„±ëœ ë‚ ì§œê°€ **2019ë…„ 1ì›”**ì´ì—ˆê±°ë“ ìš”. ë¬´ë ¤ **7ë…„** ë™ì•ˆ ì—´ë ¤ìˆë˜ ì´ìŠˆì˜€ìŠµë‹ˆë‹¤.

## ì–´ë–¤ ë¬¸ì œì˜€ì„ê¹Œ?

[ì´ì „ ê¸€](/shaka-renewal-licensing/)ì—ì„œ ë‹¤ë¤˜ë˜ ë¼ì´ì„ ìŠ¤ **ê°±ì‹ **ì€ ë§Œë£Œê°€ ë‹¤ê°€ì˜¬ ë•Œ ë¯¸ë¦¬ ìƒˆ ë¼ì´ì„ ìŠ¤ë¥¼ ë°›ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ë‹¤ë¥¸ ìƒí™©ì…ë‹ˆë‹¤. **ì‚¬ìš© ê°€ëŠ¥í•œ í‚¤ê°€ ì—†ë‹¤ëŠ” ì‹ í˜¸ë¥¼ ë°›ì•˜ì„ ë•Œ, ì•±ì´ ì§ì ‘ ëŒ€ì‘í•  ìˆ˜ ìˆëŠ” ë°©ë²•**ì´ í•„ìš”í•œ ê²ƒì´ì£ .

ì´ ì´ìŠˆëŠ” [#1771](https://github.com/shaka-project/shaka-player/issues/1771)ì˜ í›„ì†ìœ¼ë¡œ, Shaka Playerê°€ "ì‚¬ìš© ê°€ëŠ¥í•œ í‚¤ê°€ ì—†ë‹¤"ê³  ì•±ì— ì•Œë ¤ì£¼ë©´, ì•±ì´ ìŠ¤ìŠ¤ë¡œ ë¼ì´ì„ ìŠ¤ë¥¼ ë‹¤ì‹œ ìš”ì²­í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ í•µì‹¬ì´ì—ˆìŠµë‹ˆë‹¤.

ì–´ë–¤ ìƒí™©ì—ì„œ í•„ìš”í• ê¹Œìš”?

- **ë…¸íŠ¸ë¶ ì ˆì „ ëª¨ë“œ**: ì˜ìƒì„ ë³´ë‹¤ê°€ ë…¸íŠ¸ë¶ì„ ë®ì—ˆë‹¤ê°€ ì—´ë©´, ë¼ì´ì„ ìŠ¤ê°€ ë§Œë£Œë˜ì–´ ëª¨ë“  í‚¤ê°€ "expired" ìƒíƒœê°€ ë©ë‹ˆë‹¤
- **ìŠ¤ë§ˆíŠ¸ TV ë°±ê·¸ë¼ìš´ë“œ**: ì•±ì„ ë°±ê·¸ë¼ìš´ë“œë¡œ ë‘ì—ˆë‹¤ê°€ ëŒì•„ì˜¤ë©´, ê·¸ ì‚¬ì´ ë¼ì´ì„ ìŠ¤ê°€ ë§Œë£Œë˜ì–´ ì¬ìƒì´ ë¶ˆê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. ì‹¤ì œë¡œ ì´ìŠˆ ì½”ë©˜íŠ¸ì—ì„œ Tizen ë””ë°”ì´ìŠ¤ ì‚¬ìš©ìê°€ [ì´ ë¬¸ì œì— ëŒ€í•œ ì»¤ë©˜íŠ¸ë¥¼](https://github.com/shaka-project/shaka-player/issues/1772#issuecomment-1217243613) í•˜ê¸°ë„ í–ˆìŠµë‹ˆë‹¤
- **ë¼ì´ì„ ìŠ¤ ìš”ì²­ ì‹¤íŒ¨**: ë„¤íŠ¸ì›Œí¬ ë¶ˆì•ˆì •ì´ë‚˜ ì„œë²„ ì¥ì• ë¡œ ë¼ì´ì„ ìŠ¤ ì„œë²„ì— ë„ë‹¬í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°

ê¸°ì¡´ Shaka Playerì—ëŠ” ìŠ¤íŠ¸ë¦¬ë° ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„í•˜ëŠ” `retryStreaming()`ì€ ìˆì—ˆì§€ë§Œ, **DRM ë¼ì´ì„ ìŠ¤ ì‹¤íŒ¨ì— ëŒ€í•œ ì¬ì‹œë„ ë©”ì»¤ë‹ˆì¦˜ì€ ì—†ì—ˆìŠµë‹ˆë‹¤.** ë¼ì´ì„ ìŠ¤ ìš”ì²­ì´ í•œ ë²ˆ ì‹¤íŒ¨í•˜ë©´ ê·¸ëŒ€ë¡œ fatal errorê°€ ë˜ì–´ ì˜ìƒì´ ë©ˆì¶°ë²„ë ¸ì£ . ê·¸ë˜ì„œ ì´ì™€ ëŒ€ì‘ë˜ëŠ” `retryLicensing()`ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤.

## EME ìŠ¤í™ì˜ ì œì•½: `generateRequest()`ëŠ” í•œ ë²ˆë§Œ

êµ¬í˜„ì„ ì‹œì‘í•˜ê¸° ì „ì—, ì´ ì´ìŠˆì—ì„œ ëˆˆì— ë“¤ì–´ì˜¨ ì½”ë©˜íŠ¸ê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

> My assumptions here were incorrect and it cannot be implemented in a way I described. `MediaKeySession` allows to call `generateRequest()` only once - if session is initialized, it will fail.

ì²˜ìŒì—ëŠ” "ê°™ì€ ì„¸ì…˜ì—ì„œ `generateRequest()`ë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•˜ë©´ ë˜ëŠ” ê±° ì•„ë‹Œê°€?"ë¼ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ [W3C EME ìŠ¤í™](https://w3c.github.io/encrypted-media/#dom-mediakeysession-generaterequest)ì„ ìì„¸íˆ ë“¤ì—¬ë‹¤ë³´ë‹ˆ, ê·¸ê²Œ ë¶ˆê°€ëŠ¥í•œ ì´ìœ ê°€ ëª…í™•í–ˆìŠµë‹ˆë‹¤.

### `generateRequest()`ëŠ” ì–´ë–»ê²Œ ë™ì‘í• ê¹Œ?

`generateRequest()`ëŠ” `initData`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¼ì´ì„ ìŠ¤ ìš”ì²­ ë©”ì‹œì§€ë¥¼ ìƒì„±í•˜ëŠ” ë©”ì„œë“œì…ë‹ˆë‹¤. W3C EME ìŠ¤í™ì— ì •ì˜ëœ ì´ ë©”ì„œë“œì˜ ì „ì²´ ë™ì‘ì„ ë‹¨ê³„ë³„ë¡œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

#### 1ë‹¨ê³„: ì„¸ì…˜ ìƒíƒœ ê²€ì‚¬ì™€ ì ê¸ˆ

ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©´ ê°€ì¥ ë¨¼ì € ì„¸ì…˜ì˜ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

1. ì„¸ì…˜ì˜ `closing` ë˜ëŠ” `closed` ê°’ì´ `true`ì´ë©´ â†’ `InvalidStateError`ë¡œ reject
2. ì„¸ì…˜ì˜ `uninitialized` ê°’ì´ `false`ì´ë©´ â†’ `InvalidStateError`ë¡œ reject
3. **`uninitialized`ë¥¼ `false`ë¡œ ì„¤ì •**

#### 2ë‹¨ê³„: ì…ë ¥ê°’ ê²€ì¦

ì´í›„ ì…ë ¥ íŒŒë¼ë¯¸í„°ë¥¼ ìˆœì„œëŒ€ë¡œ ê²€ì¦í•©ë‹ˆë‹¤.

1. `initDataType`ì´ ë¹ˆ ë¬¸ìì—´ì´ë©´ â†’ `TypeError`ë¡œ reject
2. `initData`ê°€ ë¹ˆ ë°°ì—´ì´ë©´ â†’ `TypeError`ë¡œ reject
3. CDMì´ í•´ë‹¹ `initDataType`ì„ ì§€ì›í•˜ì§€ ì•Šìœ¼ë©´ â†’ `NotSupportedError`ë¡œ reject

#### 3ë‹¨ê³„: initData Sanitize

ì—¬ê¸°ì„œë¶€í„°ëŠ” **ë³‘ë ¬(parallel)** ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

1. `initData`ê°€ í•´ë‹¹ `initDataType`ì— ëŒ€í•´ ìœ íš¨í•œì§€ ê²€ì¦
2. ìœ íš¨í•œ `initData`ë¥¼ sanitized init dataë¡œ ë³€í™˜

<img src="./w3c-sanitize-initData.png" alt="W3C EME ìŠ¤í™ì˜ initData ì •ì œ ìš”êµ¬ì‚¬í•­" style="width: 100%; display: block; margin: 0 auto;">

W3Cë¥¼ ë³´ë©´ ì´ ì •ì œ ê³¼ì •ì— ëŒ€í•´ ë„¤ ë‹¨ê³„ì˜ ìš”êµ¬ì‚¬í•­ì„ ëª…ì‹œí•˜ëŠ”ë°ìš”.

- **MUST**: ë¸Œë¼ìš°ì €ëŠ” `initData`ë¥¼ CDMì— ì „ë‹¬í•˜ê¸° ì „ì— ì² ì €í•˜ê²Œ ê²€ì¦í•´ì•¼ í•©ë‹ˆë‹¤. í•„ë“œì˜ ê¸¸ì´ì™€ ê°’ì´ í•©ë¦¬ì ì¸ì§€, ê°’ì´ í—ˆìš© ë²”ìœ„ ë‚´ì— ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ê´€ë ¨ ì—†ê±°ë‚˜ ì§€ì›í•˜ì§€ ì•Šê±°ë‚˜ ì•Œ ìˆ˜ ì—†ëŠ” ë°ì´í„°ë‚˜ í•„ë“œëŠ” ì œê±°í•´ì•¼ í•©ë‹ˆë‹¤
- **RECOMMENDED** (ê¶Œì¥): ë¸Œë¼ìš°ì €ê°€ `initData`ë¥¼ ì‚¬ì „ íŒŒì‹±í•˜ê³ , ì™„ì „íˆ ì •ì œëœ ë²„ì „ì„ ì§ì ‘ ìƒì„±í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤
- **SHOULD** (í•´ì•¼ í•¨): `initData`ì— ì—¬ëŸ¬ í•­ëª©ì´ í¬í•¨ëœ ê²½ìš°, CDMì— ë¶ˆí•„ìš”í•œ í•­ëª©ì€ ì œê±°í•´ì•¼ í•©ë‹ˆë‹¤
- **MUST NOT** (ì ˆëŒ€ ê¸ˆì§€): ë¸Œë¼ìš°ì €ëŠ” `initData` ë‚´ì˜ **í•­ëª© ìˆœì„œë¥¼ ì ˆëŒ€ ë³€ê²½í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤**

ì •ì œê°€ ì‹¤íŒ¨í•˜ë©´ `TypeError`ë¡œ rejectí•˜ê³ , ì •ì œ í›„ ë°ì´í„°ê°€ ë¹„ì–´ìˆìœ¼ë©´ `NotSupportedError`ë¡œ rejectí•©ë‹ˆë‹¤.

#### 4ë‹¨ê³„: CDMì—ê²Œ ë¼ì´ì„ ìŠ¤ ìš”ì²­ ìƒì„± ìœ„ì„

ì •ì œëœ `initData`ë¥¼ CDMì— ì „ë‹¬í•©ë‹ˆë‹¤. CDMì€ ë¨¼ì € ìì‹ ì´ ì´ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ì„¸ì…˜ íƒ€ì…ì— ë”°ë¼ ë¶„ê¸°í•©ë‹ˆë‹¤.

- `"temporary"` â†’ ë°˜í™˜ë˜ëŠ” ë¼ì´ì„ ìŠ¤ëŠ” ì˜êµ¬ ì €ì¥í•  ìˆ˜ ì—†ì–´ì•¼ í•©ë‹ˆë‹¤
- `"persistent-license"` â†’ **ê³ ìœ í•œ ì„¸ì…˜ ID ìƒì„±**ì„ í•˜ê²Œ ë˜ëŠ”ë° ì´ë•Œ í•´ë‹¹ ì˜¤ë¦¬ì§„ ë‚´ì—ì„œ ì‹œê°„ì´ ì§€ë‚˜ë„, ë‹¤ë¥¸ ë¬¸ì„œë‚˜ ë¸Œë¼ìš°ì§• ì„¸ì…˜ì—ì„œë„ ìœ ì¼í•´ì•¼ í•©ë‹ˆë‹¤

CDMì´ ì •ì œëœ `initData`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¼ì´ì„ ìŠ¤ ìš”ì²­ì„ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©´ `"license-request"` íƒ€ì…ì˜ ë©”ì‹œì§€ë¥¼ ë§Œë“­ë‹ˆë‹¤. ë§Œì•½ ë¼ì´ì„ ìŠ¤ë¥¼ ìš”ì²­í•˜ê¸° ì „ì— ë³„ë„ì˜ ì²˜ë¦¬(ì˜ˆ: individualization)ê°€ í•„ìš”í•˜ë©´, `"individualization-request"` íƒ€ì…ì˜ ë©”ì‹œì§€ë¥¼ ë¨¼ì € ë§Œë“­ë‹ˆë‹¤.

ì´ ê³¼ì •ì—ì„œ ìŠ¤í™ì´ ëª…ì‹œí•˜ëŠ” ë‘ ê°€ì§€ ì œì•½ì´ ìˆìŠµë‹ˆë‹¤.

- CDMì€ **`initData` ì™¸ì˜ ìŠ¤íŠ¸ë¦¼ë³„ ë°ì´í„°(ë¯¸ë””ì–´ ë°ì´í„° ë“±)ë¥¼ ì‚¬ìš©í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤**
- CDMì€ ì´ ì‹œì ì—ì„œ **ì„¸ì…˜ ë°ì´í„°ë¥¼ ì €ì¥í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤** (ì €ì¥ì€ ì´í›„ `update()` í˜¸ì¶œ ì‹œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤)

#### 5ë‹¨ê³„: ê²°ê³¼ ì²˜ë¦¬

ëª¨ë“  ê³¼ì •ì´ ì„±ê³µí•˜ë©´ ìµœì¢… ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.

- ë¦¬ì†ŒìŠ¤ ë¶€ì¡±ìœ¼ë¡œ ì‹¤íŒ¨í–ˆë‹¤ë©´ â†’ `QuotaExceededError`ë¡œ reject
- ê·¸ ì™¸ ì´ìœ ë¡œ ì‹¤íŒ¨í–ˆë‹¤ë©´ â†’ ì ì ˆí•œ `DOMException`ìœ¼ë¡œ reject
- ì„±ê³µ ì‹œ:
  - ì„¸ì…˜ì˜ `sessionId` ì†ì„±ì„ ì„¤ì •
  - ì„¸ì…˜ì˜ `callable` ê°’ì„ `true`ë¡œ ë³€ê²½
  - promiseë¥¼ resolve
  - `"license-request"` ë˜ëŠ” `"individualization-request"` íƒ€ì…ì˜ **`message` ì´ë²¤íŠ¸ë¥¼ íì— ë„£ìŒ**

ì´ `message` ì´ë²¤íŠ¸ê°€ ë°”ë¡œ ë¼ì´ì„ ìŠ¤ ì„œë²„ì— ë³´ë‚¼ ìš”ì²­ ë©”ì‹œì§€ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì´ ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì‹ í•´ì„œ ë¼ì´ì„ ìŠ¤ ì„œë²„ì— ì „ë‹¬í•˜ê³ , ì‘ë‹µì„ `update()` ë©”ì„œë“œë¡œ ì„¸ì…˜ì— ì „ë‹¬í•˜ëŠ” ê²ƒì´ì£ .

## ê·¸ë˜ì„œ ê²°êµ­ ì™œ í•œ ë²ˆë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆì„ê¹Œ?

ë‹¤ì‹œ 1ë‹¨ê³„ë¡œ ëŒì•„ê°€ë³´ê² ìŠµë‹ˆë‹¤.

```text
ì²« ë²ˆì§¸ í˜¸ì¶œ:
  uninitialized = true  â†’ ìƒíƒœ í™•ì¸ í†µê³¼ âœ…
  â†’ uninitialized = falseë¡œ ë³€ê²½
  â†’ initData ê²€ì¦ â†’ ì •ì œ â†’ CDM ìœ„ì„ â†’ ë¼ì´ì„ ìŠ¤ ìš”ì²­ ìƒì„±

ë‘ ë²ˆì§¸ í˜¸ì¶œ:
  uninitialized = false â†’ InvalidStateError âŒ (1ë‹¨ê³„ì—ì„œ ì¦‰ì‹œ ê±°ë¶€)
```

`uninitialized` í”Œë˜ê·¸ëŠ” í•œ ë²ˆ `false`ê°€ ë˜ë©´ ë‹¤ì‹œ `true`ë¡œ ëŒì•„ê°€ëŠ” ë°©ë²•ì´ ì—†ìŠµë‹ˆë‹¤. ì¦‰, `generateRequest()`ëŠ” **ì„¸ì…˜ì˜ ìƒì• ì£¼ê¸°ì—ì„œ ë”± í•œ ë²ˆë§Œ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ”** ì¼ë°©í†µí–‰ ë©”ì„œë“œì¸ ê²ƒì´ì£ .

ì´ê²ƒì€ EME ìŠ¤í™ì´ **í•˜ë‚˜ì˜ ì„¸ì…˜ = í•˜ë‚˜ì˜ ì´ˆê¸°í™” ë°ì´í„°**ë¼ëŠ” ì›ì¹™ì„ ë”°ë¥´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. í•˜ë‚˜ì˜ ì„¸ì…˜ì´ í•˜ë‚˜ì˜ `initData`ì—ë§Œ ë°”ì¸ë”©ë˜ë©´, CDMì´ ê´€ë¦¬í•´ì•¼ í•  ìƒíƒœê°€ ëª…í™•í•´ì§€ê³ , ì„¸ì…˜ ì¬ì´ˆê¸°í™”ë¡œ ì¸í•œ ë³´ì•ˆ ë¬¸ì œ(ì„¸ì…˜ í•˜ì´ì¬í‚¹, ë¼ì´ì„ ìŠ¤ ìš°íšŒ ë“±)ë„ ì›ì²œ ì°¨ë‹¨ë©ë‹ˆë‹¤.

**ê²°êµ­ì—ëŠ”...**
ê°™ì€ ì„¸ì…˜ì—ì„œ ë¼ì´ì„ ìŠ¤ë¥¼ ë‹¤ì‹œ ìš”ì²­í•˜ëŠ” ê±´ ìŠ¤í™ ë ˆë²¨ì—ì„œ **ë¶ˆê°€ëŠ¥**í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ë‚¨ì€ ì„ íƒì§€ëŠ” í•˜ë‚˜ë¿ì´ì—ˆìŠµë‹ˆë‹¤. **ê¸°ì¡´ ì„¸ì…˜ì„ ë‹«ê³ , ìƒˆ ì„¸ì…˜ì„ ë§Œë“¤ì–´ì„œ, ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•˜ê¸°**

## êµ¬í˜„ ê³¼ì •ì—ì„œì˜ ë‘ ê°€ì§€ ê±±ì •

ì„¸ì…˜ì„ ë‹«ê³  ìƒˆë¡œ ë§Œë“œëŠ” ë°©ì‹ì—ëŠ” ë‘ ê°€ì§€ ê±±ì •ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ì´ìŠˆì—ì„œë„ Open Questionìœ¼ë¡œ ë‚¨ì•„ìˆë˜ ë‚´ìš©ì´ì—ìš”.

### 1. ì„¸ì…˜ì„ ë‹«ëŠ” ë™ì•ˆ ë¹„ë””ì˜¤ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šì„ê¹Œ?

ê¸°ì¡´ ì„¸ì…˜ì„ ë‹«ìœ¼ë©´ ì ê¹ì´ì§€ë§Œ í‚¤ê°€ ì—†ëŠ” ìƒíƒœê°€ ë©ë‹ˆë‹¤. ì´ ì‚¬ì´ì— ë¹„ë””ì˜¤ ì—˜ë¦¬ë¨¼íŠ¸ê°€ "í‚¤ê°€ ì—†ë‹¤!"ê³  ì—ëŸ¬ë¥¼ ë˜ì§ˆ ìˆ˜ ìˆì§€ ì•Šì„ê¹Œìš”?

ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸í•´ë³´ë‹ˆ, CDMì´ ì •ë¦¬í•  ì‹œê°„ì„ ì•½ê°„ ì£¼ë©´ ë¬¸ì œê°€ ì—†ì—ˆìŠµë‹ˆë‹¤. ì„¸ì…˜ì„ ë‹«ì€ ë’¤ **0.1ì´ˆì˜ ë”œë ˆì´**ë¥¼ ë‘ê³  ìƒˆ ì„¸ì…˜ì„ ìƒì„±í•˜ëŠ” ê²ƒìœ¼ë¡œ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

### 2. `encrypted` ì´ë²¤íŠ¸ê°€ ë‹¤ì‹œ ë°œìƒí• ê¹Œ?

ìµœì´ˆ ë¼ì´ì„ ìŠ¤ ìš”ì²­ì€ ë¸Œë¼ìš°ì €ê°€ ì•”í˜¸í™”ëœ ì½˜í…ì¸ ë¥¼ ê°ì§€í•˜ë©´ì„œ ì‹œì‘ë©ë‹ˆë‹¤. `encrypted` ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ê³ , ì´ ì´ë²¤íŠ¸ì—ì„œ `initData`ë¥¼ ë°›ì•„ ì„¸ì…˜ì„ ìƒì„±í•˜ì£ .

í•˜ì§€ë§Œ ì„¸ì…˜ì„ ë‹«ê³  ìƒˆë¡œ ë§Œë“¤ì–´ë„, **`encrypted` ì´ë²¤íŠ¸ëŠ” ë‹¤ì‹œ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.** ì´ ì´ë²¤íŠ¸ëŠ” ë¸Œë¼ìš°ì €ê°€ ì•”í˜¸í™”ëœ ì½˜í…ì¸ ë¥¼ **ì²˜ìŒ** ë§Œë‚¬ì„ ë•Œë§Œ ë°œìƒí•˜ê¸° ë•Œë¬¸ì´ì—ìš”.

í•´ê²°ì±…ì€ ê°„ë‹¨í–ˆìŠµë‹ˆë‹¤. ì„¸ì…˜ì„ ì²˜ìŒ ìƒì„±í•  ë•Œ `initData`ì™€ `initDataType`ì„ ì„¸ì…˜ ë©”íƒ€ë°ì´í„°ì— **ì €ì¥**í•´ë‘ëŠ” ê²ƒì´ì£ . `retryLicensing()`ì´ í˜¸ì¶œë˜ë©´ ì €ì¥í•´ë‘” ë°ì´í„°ë¡œ ìƒˆ ì„¸ì…˜ì˜ `generateRequest()`ë¥¼ í˜¸ì¶œí•˜ë©´ ë©ë‹ˆë‹¤.

```javascript
// ì„¸ì…˜ ìƒì„± ì‹œ initData ì €ì¥
const metadata = {
  initData: initData,
  initDataType: initDataType,
  // ...
};

// retryLicensing() í˜¸ì¶œ ì‹œ ì €ì¥ëœ ë°ì´í„° ì‚¬ìš©
async retryLicensing(sessionMetadata, retryDelaySeconds = 0.1) {
  // 1. ê¸°ì¡´ ì„¸ì…˜ ë‹«ê¸°
  await oldSession.close();

  // 2. CDM ì •ë¦¬ ì‹œê°„
  await shaka.util.Functional.delay(retryDelaySeconds);

  // 3. ìƒˆ ì„¸ì…˜ ìƒì„± + ì €ì¥í•´ë‘” initDataë¡œ ë¼ì´ì„ ìŠ¤ ìš”ì²­
  const newSession = mediaKeys.createSession();
  await newSession.generateRequest(
    sessionMetadata.initDataType,
    sessionMetadata.initData
  );
}
```

## ì½”ë“œ ë¦¬ë·°ì—ì„œ ë°°ìš´ ê²ƒë“¤

### delay() ìœ í‹¸ë¦¬í‹° ì¶”ì¶œ

`retryLicensing()`ì—ì„œ ì‚¬ìš©í•œ ë”œë ˆì´ ë¡œì§ì„ êµ¬í˜„í–ˆëŠ”ë°, ì½”ë“œ ë¦¬ë·°ì—ì„œ ì´ëŸ° ì½”ë©˜íŠ¸ê°€ ë‹¬ë ¸ìŠµë‹ˆë‹¤.

> "This is a candidate to go in `shaka.util.Functional`. We already use this in several parts of the code and it makes sense to make it a utility."

ë¹„ìŠ·í•œ ë”œë ˆì´ íŒ¨í„´ì´ ì½”ë“œë² ì´ìŠ¤ ì—¬ëŸ¬ ê³³ì— ì‚°ì¬í•´ ìˆìœ¼ë‹ˆ, ê³µí†µ ìœ í‹¸ë¦¬í‹°ë¡œ ì¶”ì¶œí•˜ë¼ëŠ” ê²ƒì´ì—ˆì£ . ë‹¨ìˆœíˆ ê¸°ëŠ¥ êµ¬í˜„ì— ê·¸ì¹˜ì§€ ì•Šê³ , **ì½”ë“œë² ì´ìŠ¤ ì „ì²´ì˜ í’ˆì§ˆì„ í•¨ê»˜ ê°œì„ **í•˜ëŠ” ê²½í—˜ì´ì—ˆìŠµë‹ˆë‹¤.

### Tizen 3 ë””ë°”ì´ìŠ¤ ë©

Shaka PlayerëŠ” ë‹¨ìˆœíˆ ë¸Œë¼ìš°ì € CIë§Œ ëŒë¦¬ëŠ” ê²Œ ì•„ë‹™ë‹ˆë‹¤. **ì‹¤ì œ ë””ë°”ì´ìŠ¤ ë©**ì—ì„œ ìŠ¤ë§ˆíŠ¸ TV, ì…‹í†±ë°•ìŠ¤ ë“± ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.

í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•œ ë’¤ ë””ë°”ì´ìŠ¤ ë©ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ëŒë ¸ëŠ”ë°, **Tizen 3ì—ì„œ ì‹¤íŒ¨**í–ˆìŠµë‹ˆë‹¤.

ê²°êµ­ Tizen 3ì—ì„œëŠ” í•´ë‹¹ í…ŒìŠ¤íŠ¸ë¥¼ pending ì²˜ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ë§ˆë¬´ë¦¬í–ˆìŠµë‹ˆë‹¤.

```javascript
if (deviceDetected.getDeviceName() === 'Tizen' && deviceDetected.getVersion() === 3) {
  pending('retryLicensing is not supported on Tizen 3');
}
```

PC ë¸Œë¼ìš°ì €ë§Œ ìƒê°í•˜ë˜ ì €ì—ê²Œ, ìŠ¤ë§ˆíŠ¸ TV í”Œë«í¼ê¹Œì§€ ê³ ë ¤í•´ì•¼ í•˜ëŠ” ë¯¸ë””ì–´ í”Œë ˆì´ì–´ì˜ í˜„ì‹¤ì„ ì‹¤ê°í•œ ìˆœê°„ì´ì—ˆìŠµë‹ˆë‹¤.

## ë§ˆì¹˜ë©°

ì´ë²ˆ PRë¡œ Shaka Playerì— ë„¤ ë²ˆì§¸ ê¸°ì—¬ë¥¼ ë§ˆì³¤ìŠµë‹ˆë‹¤. 7ë…„ ë™ì•ˆ ì—´ë ¤ìˆë˜ ì´ìŠˆë¥¼ í•´ê²°í–ˆë‹¤ëŠ” ê²ƒë„ ë¿Œë“¯í•˜ì§€ë§Œ, í•œ ë²ˆì˜ ê¸°ì—¬ê°€ ë‹¤ìŒ ê¸°ì—¬ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ì´ì–´ì§€ëŠ” ê²½í—˜ì´ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ê³„ì†í•˜ê²Œ ë§Œë“œëŠ” ê°€ì¥ í° ì›ë™ë ¥ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

> ğŸ”— ì´ì „ ê¸€ì´ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´:
>
> - [Google Shaka Playerì— ì²« PRì„ ë³´ëƒˆìŠµë‹ˆë‹¤](/shaka-player/) - EME MediaKeySessionClosedReason êµ¬í˜„
> - [TC39 proposal-upsertë¥¼ Shaka Playerì— ì ìš©í•˜ê¸°ê¹Œì§€](/shaka-tc39/) - Map.getOrInsert í´ë¦¬í•„
> - [DRMë„ ê°±ì‹ í•˜ëŠ” ë²•ì´ ë‹¤ë¦…ë‹ˆë‹¤](/shaka-renewal-licensing/) - DRM ë¼ì´ì„ ìŠ¤ ìë™ ê°±ì‹ 

## ê´€ë ¨ ë§í¬

### GitHub

- [PR #9638: feat(EME): Add retryLicensing() and failureCallback for manual license retry](https://github.com/shaka-project/shaka-player/pull/9638)
- [Issue #1772: Add Player.retryLicensing()](https://github.com/shaka-project/shaka-player/issues/1772)

### ê³µì‹ ë¬¸ì„œ

- [W3C EME - MediaKeySession.generateRequest()](https://w3c.github.io/encrypted-media/#dom-mediakeysession-generaterequest)
